/**
 * LALA BOUTIQUE - Extreme Optimized Detail Logic
 */

// 1. 데이터 레이어 (132개 상품 고유 설명 매핑)
const productData = {
    coat: ["프리미엄 캐시미어 블렌드 코트", ["부드러운 터치감의 최고급 캐시미어 혼방 소재", "우아한 실루엣을 완성하는 더블 브레스티드 라인", "세련된 도시적 감각의 미니멀 롱 코트", "보온성과 스타일을 모두 잡은 핸드메이드 마감", "클래식한 매력의 오버사이즈 테일러드 코트", "유연한 드레이프성이 돋보이는 숄 칼라 디자인", "고급스러운 광택이 흐르는 이탈리아산 울 소재", "벨트 디테일로 슬림한 라인을 강조한 코트", "차분한 톤의 멜란지 컬러가 매력적인 데일리 코트", "구조적인 어깨 라인이 돋보이는 모던 실루엣", "가벼우면서도 따뜻한 압축 울 펠트 공법 적용", "브랜드 헤리티지를 담은 시그니처 체크 코트"]],
    shirts: ["실루엣 오버핏 포플린 셔츠", ["바스락거리는 질감의 코튼", "자연스러운 린넨 셔츠", "섬세한 스티치 드레스 셔츠", "여유로운 오버사이즈 핏", "은은한 자개 단추 디테일", "깔끔한 밴드 칼라", "뒷면 플리츠 디테일", "부드러운 실크 터치", "경쾌한 스트라이프", "실용적인 워크 셔츠", "와이드 커프스 디자인", "에센셜한 데일리 셔츠"]],
    sweater: ["헤리티지 모헤어 라운드 니트", ["포근한 모헤어 울", "입체적인 꽈배기 조직", "솔기 없는 홀가먼트", "감각적인 컬러 배색", "탄탄한 메리노 울", "우아한 보트넥 디자인", "포근한 겨울 감성 노르딕", "가벼운 캐시미어 보온성", "빈티지 무드 루즈핏 니트", "소매 볼륨 페미닌 니트", "베이직 리브 조직 니트", "브러쉬드 텍스처 니트"]],
    pants: ["테일러드 스트레이트 슬랙스", ["하이웨이스트 스트레이트 핏", "편안한 스트레치 소재", "정교한 핀턱 디테일 라인", "매끄러운 울 블렌드 실루엣", "모던 와이드 레그 트라우저", "격식 있는 포멀 팬츠", "자연스러운 코튼 치노", "경쾌한 크롭 기장 슬랙스", "고급스러운 사틴 카고", "편안한 밴딩 슬랙스", "브리티시 체크 패턴", "세미 부츠컷 데님"]],
    skirts: ["플리츠 실크 벨벳 스커트", ["정교한 플리츠 라인", "은은한 실크 새틴 광택", "우아한 A라인 실루엣", "따뜻한 울 스커트", "슬릿 디테일 펜슬 스커트", "로맨틱 티어드 디자인", "자수 문양 미디 스커트", "활동적인 랩 스타일", "캐주얼 데님 롱 스커트", "화려한 벨벳 스커트", "미니멀 레더 텍스처", "머메이드 라인 스커트"]],
    onepiece: ["에테르 드레이프 실크 드레스", ["우아한 드레이핑 디자인", "페미닌 셔츠 원피스", "최고급 실크 착용감", "클래식 트위드 드레스", "여유로운 맥시 드레스", "레이스 칵테일 드레스", "미니멀 슬리브리스", "편안한 니트 드레스", "백 리스 포인트 원피스", "레트로 도트 드레스", "스포티 배색 원피스", "풍성한 볼륨 드레스"]],
    suit: ["시그니처 더블 브레스티드 수트", ["테일러링 정점의 핏", "비즈니스 클래식 셋업", "모던 오버 블레이저", "핀스트라이프 클래식", "슬림핏 재킷 셋업", "린넨 소재 여름 수트", "고급 트위드 셋업", "노카라 재킷 수트", "저지 소재 컴포트 수트", "벨벳 이브닝 수트", "체크 테일러드 셋업", "아방가르드 실루엣"]],
    dressshoe: ["클래식 카프스킨 페니 로퍼", ["부드러운 가죽 로퍼", "수제 카프스킨 구두", "세련된 몽크 스트랩", "안정적인 로우 힐", "시크한 스틸레토 힐", "에나멜 옥스포드화", "미니멀한 슬링백", "쿠션 인솔 슈즈", "레더 빈티지 부츠", "클래식 레이스업", "모던 스퀘어 토", "럭셔리 금속 장식"]],
    sandals: ["미니멀 스트랩 카프 레더 샌들", ["미니멀 스트랩 샌들", "시원한 에스파드류", "청키 굽 디자인", "내추럴 슬라이드", "앵클 스트랩 샌들", "메탈릭 포인트 샌들", "우드 굽 샌들", "플랫폼 샌들", "유니크 스트랩 샌들", "보석 장식 샌들", "스웨이드 뮬", "패턴 포인트 샌들"]],
    bag: ["타임리스 카세트 레더 숄더백", ["견고한 레더 숄더백", "데일리 토트백", "우아한 크로스백", "인트레치아토 기법", "라운드 버킷백", "체인 플랩백", "레더 미니 파우치", "비즈니스 브리프케이스", "캔버스 레더백", "스웨이드 호보백", "봉투형 클러치", "시그니처 참 백"]],
    hat: ["울 펠트 클래식 소프트 페도라", ["클래식 울 페도라", "캐시미어 니트 비니", "스타일리시 햇", "리본 클로슈", "럭셔리 레더 캡", "프렌치 울 베레모", "라피아 보터 햇", "이어플랩 캡", "가죽 베레모", "와이드 브림 햇", "시어링 버킷 햇", "자카드 패턴 햇"]]
};

// 2. 상태 관리 및 초기화
const state = { path: '', id: 0, price: 0 };

window.onload = () => {
    const params = new URLSearchParams(location.search);
    [state.path, state.id] = [params.get('path'), parseInt(params.get('id'))];
    
    if (!state.path || !state.id) return (location.href = 'homepage.html');

    const sub = state.path.split('/')[1];
    const [name, descs] = productData[sub] || ["라라 익스클루시브", []];
    state.price = (state.id * 15000 + 135000);

    // 렌더링
    document.getElementById('detail-img').src = `./img/${state.path}/${state.id}.jpg`;
    document.getElementById('detail-name').innerText = name;
    document.getElementById('detail-price').innerText = `KRW ${state.price.toLocaleString()}`;

    // 유저 정보 처리 (단락 평가)
    const user = JSON.parse(localStorage.getItem("signedUser") || "{}");
    const addr = document.getElementById("user-addr");
    addr && (addr.innerText = user.userAddr || "로그인 후 확인 가능합니다.");
};

// 3. 장바구니 로직
const addToCart = () => {
    const cart = JSON.parse(localStorage.getItem("cart") || "[]");
    cart.push({
        name: document.getElementById('detail-name').innerText,
        price: state.price,
        img: document.getElementById('detail-img').src,
        qty: 1 // 수량 선택 기능 추가 시 변수로 대체 가능
    });
    localStorage.setItem("cart", JSON.stringify(cart));
    confirm("장바구니에 담겼습니다. 이동하시겠습니까?") && (location.href = 'cart.html');
};